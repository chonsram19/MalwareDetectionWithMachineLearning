#!/usr/bin/env python
# coding: utf-8

# In[7]:


import pandas as pd

malData = pd.read_csv("MalwareData.csv", sep="|")

legit = malData[0:41323].drop(["legitimate"], axis=1)
mal = malData[41323::].drop(["legitimate"], axis=1)


print("The shape of the legit dataset is %s sample, %s features "%(legit.shape[0], legit.shape[1]))
print("The shape of the malware dataset  is %s sample, %s features "%(mal.shape[0], legit.shape[1]))
                                                                      



# In[9]:


print(malData.columns)


# In[10]:


print(malData.head(5))


# In[11]:


pd.set_option("display.max_columns", None)


# In[13]:


print(malData.head(5))


# In[21]:


print(legit.take([11000]))


# In[24]:


print(mal.take([1]))


# In[37]:


from sklearn.ensemble import ExtraTreesClassifier
from sklearn.feature_selection import SelectFromModel
from sklearn.model_selection import train_test_split
from sklearn.model_selection import train_test_split


# In[29]:


data_in = malData.drop(["Name", "md5", "legitimate"], axis=1).values


# In[31]:


labels = malData["legitimate"].values
extratrees = ExtraTreesClassifier().fit(data_in, labels)

select = SelectFromModel(extratrees, prefit=True)

data_in_new = select.transform(data_in)

print(data_in.shape, data_in_new.shape)


# In[35]:


import numpy as np
features = data_in_new.shape[1]
importances = extratrees.feature_importances_
indices = np.argsort(importances)[::-1]
for f in range(features):
    print("%d"%(f+1), malData.columns[2+indices[f]], importances[indices[f]])


# In[39]:


from sklearn.ensemble import RandomForestClassifier
legit_train, legit_test, mal_train, mal_test = train_test_split(data_in_new, labels, test_size=0.2)
classif = RandomForestClassifier(n_estimators=50)
classif.fit(legit_train, mal_train)


# In[40]:


print("The score of the algorithm: ", classif.score(legit_test, mal_test)*100)


# In[43]:


from sklearn.metrics import confusion_matrix
result= classif.predict(legit_test)
conf_mat = confusion_matrix(mal_test, result)

conf_mat


# In[44]:


print("False Positive: ", conf_mat[0][1]/ sum(conf_mat[0]) * 100)
print("False negative: ", conf_mat[1][0]/sum(conf_mat[1])* 100)


# In[46]:


from  sklearn.ensemble import GradientBoostingClassifier
grad_boost = GradientBoostingClassifier(n_estimators=50)
grad_boost.fit(legit_train, mal_train)

print("The score of the GRADIENT BOOSTING CLASSFIER is ", grad_boost.score(legit_test, mal_test) * 100)


# In[ ]:




